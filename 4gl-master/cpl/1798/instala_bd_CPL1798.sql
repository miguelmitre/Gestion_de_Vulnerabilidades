SELECT folio        ,
       nss          ,
       consecutivo  ,
       tipo_retiro
FROM   ret_solicitud_tx
WHERE  folio IN (37550, 37565, 37585, 37614)
AND    nss IN (
"13644710074", "53744901694", "53794806991",
"52664710556", "54824816992", "53825202608",
"62695213249", "54845439386", "54705411731",
"65815420974", "55725110625", "54835335313",
"01593523424", "55745211940", "54874905331",
"01664515796", "55754811135", "55785400460",
"01674894371", "65644717921", "62715420824",
"01694225408", "65674727196", "64815102922",
"01695249019", "65675023546", "65685210232",
"01695331288", "65684923934", "65695219298",
"01704884426", "65695018203", "65815309680",
"01715453104", "65705311671", "67725401722",
"01724960016", "65715415553", "67754202363",
"01725174195", "65795301954", "67785918110",
"01725382897", "65815400638", "67795300010",
"01735044461", "65964300159", "67805506044",
"01755372834", "67725101777", "67805517934",
"01765424708", "67725406051", "67965225229",
"03654927452", "67745417641", "71715304045",
"03675017762", "67755409132", "71765501193",
"04705104323", "67835430355", "72664911491",
"04754700088", "67855434048", "78644711547",
"06715412109", "67875200122", "83795410436",
"06755424709", "67955488019", "83805402910",
"06785410926", "67965125197", "83815404278",
"11664977896", "71715101888", "88844600044",
"11715234412", "71715501830", "01715112635",
"12724901645", "71765103966", "01725199960",
"12744301487", "71785302648", "01744828706",
"12785507224", "71785405607", "04015400577",
"15695310324", "71855504438", "04715423317",
"16775303254", "72735416991", "04725101291",
"19775201981", "78854500713", "04735333736",
"21725325134", "83705112163", "04755420025",
"23634610267", "83794802658", "04925200356",
"23664711308", "83805305899", "06705120860",
"23664814896", "01564103966", "06715432602",
"23675115200", "01665071849", "06735305473",
"23684919345", "01695126019", "06785305613",
"23695214660", "01715116073", "11674940421",
"23695410110", "01715302137", "11694802155",
"23705416511", "06564101316", "11705227012",
"23715301356", "06745443140", "11715056328",
"23725406252", "06765438277", "12705317936",
"23745417040", "11664745376", "12816354463",
"23754804369", "11685189869", "13604610405",
"23755407881", "11704901245", "13705210733",
"23775406582", "12695011861", "14715205283",
"23775410295", "12715315037", "16715402158",
"23775604731", "12725215714", "17815406578",
"23785405020", "12735413739", "21685013977",
"23785408503", "12755302689", "21704919915",
"23805402361", "12795408892", "21745212973",
"23824703435", "12814605445", "23684312178",
"23825402508", "12845404487", "23684716675",
"23834600266", "14744701609", "23685012405",
"23835500796", "22843900238", "23685215388",
"23845405630", "22904500521", "23715414779",
"23854800861", "23704815101", "23765309796",
"23885401127", "23725404877", "23805402130",
"23887221424", "23735402218", "23814900678",
"23915303210", "23745416968", "23845400011",
"23924502612", "23754403196", "23865304325",
"23955807021", "23765103173", "23866706783",
"24684610538", "23765404332", "24705420578",
"24684916141", "23805103423", "24725215719",
"24714201498", "23835100100", "24765405592",
"24725200612", "23845403148", "24775301716",
"24735007536", "23884700727", "24816541551",
"24765303292", "23895403246", "24855411914",
"24775717242", "23965401716", "24915415038",
"24845407816", "24704212695", "32654912883",
"31705314677", "24735109902", "32775401972",
"31705417066", "24744804683", "39905404412",
"31805401515", "24745315564", "39915400871",
"32735438155", "24745408120", "39955101066",
"32754416215", "24755403375", "41884800131",
"33735403983", "24795410893", "42814702157",
"33744908659", "24875107104", "43735334922",
"33784901705", "30955301251", "49654624565",
"33795415786", "31705012008", "49685031103",
"33825001333", "31814101098", "49685124288",
"33875434343", "32754611427", "49725420191",
"34855501366", "32764913623", "49775405217",
"35947862047", "32917555909", "49815410524",
"42845201849", "33685211170", "51745403355",
"43715424883", "33795413203", "54755914956",
"43715444220", "33804001999", "55844900328",
"43725452478", "33815420287", "55915101434",
"43755419702", "33895430495", "55975400601",
"49664611057", "33897213477", "56975600646",
"49724906406", "34785400952", "62735206120",
"49725422049", "41805404377", "62755208378",
"49745402559", "43705325678", "62805411238",
"49805301840", "43715419420", "65715405257",
"49805404834", "43724511894", "65785410385",
"49805407969", "49734804534", "67735410788",
"49915309048", "49785400307", "67814930425",
"52815503447", "52824900386", "67904825261",
"53725414865", "67995301487", "71855400900",
"78785302460", "83735201689", "82954400329",
"82824901753", "92934301109"
)
INTO TEMP tmp_reverso_sol
;
DELETE
FROM   dis_provision
WHERE  folio    IN (SELECT folio
                    FROM   tmp_reverso_sol
                   )
AND    consecutivo_lote IN (SELECT consecutivo
                            FROM   tmp_reverso_sol
                           )
;
DELETE
FROM  ret_monto_siefore
WHERE  folio    IN (SELECT folio
                    FROM   tmp_reverso_sol
                   )
AND    consecutivo IN (SELECT consecutivo
                       FROM   tmp_reverso_sol
                      )
;
DELETE
FROM  ret_monto_viv
WHERE  folio    IN (SELECT folio
                    FROM   tmp_reverso_sol
                   )
AND    consecutivo IN (SELECT consecutivo
                       FROM   tmp_reverso_sol
                      )
;
UPDATE cta_his_marca
SET    fecha_fin    = NULL          ,
       estado_marca = 0             ,
       marca_causa  = 0             ,
       fecha_causa  = NULL          ,
       usr_desmarca = NULL
WHERE  nss IN (SELECT nss
               FROM   tmp_reverso_sol
              )
AND    correlativo IN (SELECT consecutivo
                       FROM   tmp_reverso_sol
                      )

AND    marca_cod   = 830
;
INSERT INTO cta_act_marca
SELECT nss           ,
       marca_cod     ,
       fecha_ini     ,
       hora_ini      ,
       estado_marca  ,
       marca_causa   ,
       fecha_causa   ,
       correlativo   ,
       usr_marca
FROM   cta_his_marca
WHERE  nss IN (SELECT nss
               FROM   tmp_reverso_sol
              )
AND    correlativo IN (SELECT consecutivo
                       FROM   tmp_reverso_sol
                      )
AND    marca_cod   = 830
;
UPDATE ret_solicitud_tx
SET    acciones_ret97       = 0                 ,
       acciones_cuota_soc   = 0                 ,
       acciones_ret92       = 0                 ,
       acciones_cv          = 0                 ,
       saldo_viv97          = 0                 ,
       saldo_viv92          = 0                 ,
       saldo_viv72          = 0                 ,
       folio                = 0                 ,
       fecha_envio          = MDY(01,01,0001)   ,
       fecha_valor_viv      = MDY(01,01,0001)   ,
       estado_solicitud     = 3                 ,
       diag_registro        = NULL
WHERE  folio    IN (SELECT folio
                    FROM   tmp_reverso_sol
                   )
AND    consecutivo IN (SELECT consecutivo
                       FROM   tmp_reverso_sol
                      )
